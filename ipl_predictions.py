import numpy as np 
import pandas as pd 
import matplotlib.pyplot as plt 
import seaborn as sns 
import warnings
warnings.filterwarnings("ignore")

df = pd.read_csv("IPL.csv")
print(df.head())
print(df.info())
print(df.shape)
print(f"Your rows are {df.shape[0]} and columns are {df.shape[1]}")
print(df.isnull().sum)
match_winner = df["match_winner"].value_counts()
print(match_winner)
sns.barplot(x=match_winner.index,y=match_winner.values,palette="viridis")
plt.title("Match Winner")
plt.show()
toss_decision = df["toss_decision"].value_counts()
sns.countplot(x=df["toss_decision"],palette="viridis")
toss_and_match_winners = df[df["toss_winner"]==df["match_winner"]]["match_id"].count()
percentage_toss_and_match_winners = (toss_and_match_winners*100)/df.shape[0]
print(f"percentage_toss_and_match_winners: {percentage_toss_and_match_winners}")
print(f"toss_and_match_winners: {toss_and_match_winners}")

print(toss_decision)
plt.title("Toss Decision")
plt.show()
sns.countplot(x=df["won_by"],palette="viridis")
plt.title("Won By")
plt.show()
count = df["player_of_the_match"].value_counts().head(10)
print(count)
sns.barplot(x=count.index,y=count.values,palette="viridis")
plt.title("Player of the Match")
plt.show()
high_scorer = df.groupby("top_scorer")["highscore"].max().sort_values(ascending=False).head(2)
print(high_scorer)
sns.barplot(x=high_scorer.index,y=high_scorer.values,palette="viridis")
plt.title("High Scorer")
plt.show()
df["highest_wickets"] = df["best_bowling_figure"].apply(lambda x: x.split("-")[0])
df["highest_wickets"] = df["highest_wickets"].astype(int)
best_bowlers = df.groupby("best_bowling")["highest_wickets"].max().sort_values(ascending=False).head(2)
print(best_bowlers)
sns.barplot(x=best_bowlers.index,y=best_bowlers.values,palette="viridis")
plt.title("Best Bowlers")
plt.show()
venue_counts = df["venue"].value_counts()
print(venue_counts)
sns.barplot(x=venue_counts.index,y=venue_counts.values,palette="viridis")
plt.title("Venue Counts")
plt.show() 
print(df[df["won_by"]=="Runs"].sort_values(by="margin",ascending=False).head(1)[["match_id","venue","match_winner","margin"]])
print(df[df['highscore']==df['highscore'].max()][["highscore","top_scorer"]])
print(df[df['highest_wickets']==df['highest_wickets'].max()][["highest_wickets","best_bowling"]])
